
// Created by mousymous started at March 9 Finished at March 10

#include <netinet/in.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <arpa/inet.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <string.h>

#define PORT 1000

struct Var{

  int client_socket;

};

void _conf_address(struct sockaddr_in * address){
  address -> sin_family = AF_INET;
  address -> sin_port = htons(PORT);
  address -> sin_addr.s_addr = inet_addr("127.0.0.1");
}

void _create_socket(struct Var * var){
  if ( (var -> client_socket = socket(PF_INET, SOCK_STREAM, IPPROTO_TCP)) < 0 ){
    fprintf(stderr, "Error at building socket...\n"); exit(-1);
  }
}

int _connect_server(struct Var * var, struct sockaddr_in * address){
  while ( connect(var -> client_socket, (struct sockaddr*)&*address, sizeof(*address)) < 0){
    fprintf(stderr, "Seeking Connection...\n");
  }

  fprintf(stdout, "\n\nConnection Established...\n\n");
  return 0;
}

void _receiv_commands(struct Var * var, struct sockaddr_in * address){

  char buffer[1024];

  while(1){
    
    recv(var -> client_socket, buffer, sizeof(buffer), 0);
    printf("%s", buffer);

  }
}

int main(int argv, char * argc[]){
  struct Var var;
  struct sockaddr_in address;

  _conf_address(&address);
  _create_socket(&var);
  _connect_server(&var, &address);
  _receiv_commands(&var, &address);

  close(var.client_socket);
  return 0;
}
